# 一、模块内聚（Cohesion，低→高）

## 1) 偶然内聚（Coincidental Cohesion）—最差

**定义**：同一模块里放了一堆彼此无关的功能，只是“碰巧”放一起。  
**示例**

`# utils.py def parse_date(s): ... def send_email(msg): ... def sort_scores(xs): ...`

**改进**：按职责拆分模块（日期工具、通信、排序等）。

---

## 2) 逻辑内聚（Logical Cohesion）

**定义**：一组逻辑类别相近的功能被放在同一模块/函数里，通过**参数/分支**选择执行哪一种。  
**示例**

`def handle_io(op, path):     if op == "read": ...     elif op == "write": ...     elif op == "delete": ...`

**改进**：将分支拆为独立函数或策略类；避免“巨型开关”。

---

## 3) 时间内聚（Temporal Cohesion）

**定义**：把需要在**同一时间点**执行的操作放在一起（如启动/关闭）。  
**示例**

`def init_app():     load_config()     open_db()     warm_cache()     start_metrics()`

**改进**：允许保留，但要分清职责；为每步提供清晰接口，便于独立测试。

---

## 4) 过程内聚（Procedural Cohesion）

**定义**：因**必须的执行顺序**而放在一起，但操作围绕的**数据/目标不够统一**。  
**示例**

`def process_request(req):     log(req)     check_quota(req.user)     render_template(req)`

**改进**：将流水线分解为可复用的“步骤”对象/中间件，只保留流程编排。

---

## 5) 通信内聚（Communicational Cohesion）

**定义**：同一模块的操作**使用同一份数据**（同一输入或同一输出）。  
**示例**

`def load_user(id) -> User: ... def update_user_profile(user: User, **changes): ... def persist_user(user: User): ...`

**改进**：良好；继续围绕“同一数据实体”组织 API，保证接口聚焦。

---

## 6) 顺序内聚（Sequential Cohesion）

**定义**：一个操作的**输出**是下个操作的**输入**，形成高相关的流水线。  
**示例**

`def pipeline(raw):     tokens = tokenize(raw)     ast = parse(tokens)     return analyze(ast)`

**改进**：很好；为各阶段定义清晰契约（类型/异常），便于替换与测试。

---

## 7) 功能内聚（Functional Cohesion）—最佳

**定义**：模块/函数围绕**单一、明确的功能目标**组织，所有部分共同完成这一个功能。  
**示例**

`def compute_checksum(data: bytes) -> str:     # 单一职责：返回校验和     ...`

**改进**：保持“单一职责原则”（SRP）；通过小而稳的接口暴露功能。

## 速查对照（一句话记忆）

- **内聚（越高越好）**：偶然 < 逻辑 < 时间 < 过程 < 通信 < 顺序 < 功能
    
- **耦合（越低越好）**：非直接 < 数据 < 标记 < 控制 < 外部 < 公共 < 内容